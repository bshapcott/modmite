<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<link id="themeStyles" rel="stylesheet" href="/js/dojo-release-1.3.2-src/dijit/themes/nihilo/nihilo.css">
	<style type="text/css">
		@import "/js/dojo-release-1.3.2-src/dojo/resources/dojo.css";
	</style>
  <style type="text/css">
    TABLE {border-width: 1; border-style: solid;}
    TD {border-width: 1px; padding: 0px; border-style: solid; }
    TD.meta {background-color: AliceBlue; }
  </style>
	<script type="text/javascript" src="/js/dojo-release-1.3.2-src/dojo/dojo.js" djConfig="debugAtAllCosts:true, isDebug: true, parseOnLoad: false, dojoIframeHistoryUrl:'/js/dojo-release-1.2.0-src/dojo/resources/iframe_history.html'">
	</script>
	<script type="text/javascript" src="cx.js"></script>
	<script type="text/javascript" src="ui.js"></script>
</head>
<body class="nihilo">
	<p id="loading">Loading . . .</p>
	<script type="text/javascript">
    dojo.require("dijit.layout.BorderContainer");
    dojo.require("dijit.layout.ContentPane");
    dojo.require("dijit.form.Button");
    dojo.require("dijit.form.CheckBox");
    dojo.require("dijit.form.SimpleTextarea");
    dojo.require("dijit.Tree");
    dojo.require("dijit.Menu");
    dojo.addOnLoad( function() {

      // @todo - UI construction from data source
      ui.make_the_ui(cx);

		  //__________________________________________________________________________
		  // - quick & dirty scratch test
      function test(funcs) {
        var data = (funcs.shift())();
        var input = dijit.byId("input");
        input.attr("value", data);
        cx.send_data(data, 'application/json', function (xhr) {
          if (xhr.readyState == 4) {
            var output = dijit.byId("output");
            output.attr("value", xhr.responseText);
            cx.eval_o(xhr.responseText);
            if (funcs.length > 0) test(funcs);
          }
        });
      }
      test([
		    function () {return "/mite/game/session_start?qid=999";},
        function () {return "/mite/game/meta?qid=999&sid=" + cx.get_session();},
        function () {return "/mite/game/game_start?qid=999&sid=" + cx.get_session();},
        function () {return "/mite/game/game_state?qid=999&sid=" + cx.get_session() + "&board="
          + cx.get_cell("game.game_start.999.7", 0, 0);},
        function () {return "/mite/game/game_scope?qid=999&sid=" + cx.get_session() + "&board="
          + cx.get_cell("game.game_start.999.7", 0, 0);},
        function () {return "/mite/game/game_check?scid=" + cx.get_cell("game.game_scope.999.2", 0, 0);},
        function () {return "/mite/game/game_move?x=10&y=10&piece=" + cx.get_cell("game.game_state.999.2", 0, 0);},
        function () {return "/mite/game/game_move?x=10&y=10&piece=" + cx.get_cell("game.game_state.999.2", 1, 0);},
        function () {return "/mite/game/game_check?scid=" + cx.get_cell("game.game_scope.999.2", 0, 0);},
        function () {return "/mite/game/game_delta?scid=" + cx.get_cell("game.game_scope.999.2", 0, 0);}
      ]);  
    }); // dojo.addOnLoad	
	</script>
</body>
</html>
